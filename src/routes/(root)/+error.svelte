<script>
	import { page } from '$app/stores';

	import { dev } from '$app/environment';
	import * as Sentry from '@sentry/svelte';

	import { Standard as StandardLink } from '$elements/links';
	import seoMetaTags from '$utils/seo/metaTags';
	import Seo from '$components/Seo.svelte';

	const metaTags = ((title = 'THAT ERROR PAGE') => ({
		title,
		tags: seoMetaTags({
			title,
			description: "Well THAT's No Good.",
			openGraph: {
				type: 'website',
				url: `https://thatconference.com/`
			},
			noindex: true,
			nofollow: true
		})
	}))();

	if (!dev) {
		Sentry.captureException(new Error($page.error));
	}
</script>

<Seo title={metaTags.title} tags={metaTags.tags} />

<div class="relative px-4 py-16 sm:px-6 sm:py-24 md:grid md:place-items-center lg:px-8">
	<div class="mx-auto max-w-max">
		<main class="sm:flex">
			<p class="text-4xl font-extrabold text-that-red sm:text-5xl">{$page.status}</p>
			<div class="sm:ml-6">
				<div class="sm:border-l sm:border-gray-200 sm:pl-6">
					<div class="flex space-x-6">
						<div>
							<h1 class="text-4xl font-extrabold tracking-tight text-thatBlue-800 sm:text-5xl">
								{#if $page.status === 404}
									{#if $page.error.message}
										{$page.error.message}
									{:else}
										THAT Page not found
									{/if}
								{:else}
									Well THAT's No Good.
								{/if}
							</h1>

							<p class="mt-1 text-base text-gray-500">
								{#if $page.status === 404}
									Please check the URL in the address bar and try again.
								{:else}
									Well that's no good. We've notified the geeks and logged the error.
								{/if}
							</p>

							{#if dev && $page.error.stack}
								<p class="mt-10 max-w-lg text-base text-red-500">
									{$page.error.stack}
								</p>
							{/if}
						</div>
						<div>
							<img
								class="h-32"
								src="/images/characters/moose_with_lantern.png"
								alt="Confused Preston" />
						</div>
					</div>
				</div>
				<div class="mt-10 flex sm:border-l sm:border-transparent sm:pl-6">
					<StandardLink rel="external" class="h-3/4" href="/">Restart the Robots</StandardLink>
				</div>
			</div>
		</main>
	</div>
</div>
